# CitrineOS CSMS Deployment

**Charging Station Management System Ğ´Ğ»Ñ ĞºÑ–Ğ±ĞµÑ€Ğ¿Ğ¾Ğ»Ñ–Ğ³Ğ¾Ğ½Ñƒ**

[![OCPP 1.6](https://img.shields.io/badge/OCPP-1.6-blue)](https://www.openchargealliance.org/)
[![OCPP 2.0.1](https://img.shields.io/badge/OCPP-2.0.1-green)](https://www.openchargealliance.org/)
[![Docker](https://img.shields.io/badge/Docker-24.0+-blue)](https://www.docker.com/)

---

## ğŸ“‹ Ğ—Ğ¼Ñ–ÑÑ‚

- [ĞĞ³Ğ»ÑĞ´](#Ğ¾Ğ³Ğ»ÑĞ´)
- [ĞÑ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°](#Ğ°Ñ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°)
- [Ğ’Ğ¸Ğ¼Ğ¾Ğ³Ğ¸](#Ğ²Ğ¸Ğ¼Ğ¾Ğ³Ğ¸)
- [Ğ¨Ğ²Ğ¸Ğ´ĞºĞ¸Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚](#ÑˆĞ²Ğ¸Ğ´ĞºĞ¸Ğ¹-ÑÑ‚Ğ°Ñ€Ñ‚)
- [ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ](#Ğ½Ğ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ)
- [ĞœĞµÑ€ĞµĞ¶ĞµĞ²Ğ° ĞºĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ](#Ğ¼ĞµÑ€ĞµĞ¶ĞµĞ²Ğ°-ĞºĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ)
- [ĞŸÑ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ EVerest](#Ğ¿Ñ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ-everest)
- [Ğ’Ğ¸Ñ€Ñ–ÑˆĞµĞ½Ğ½Ñ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼](#Ğ²Ğ¸Ñ€Ñ–ÑˆĞµĞ½Ğ½Ñ-Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼)
- [ĞšĞ¾Ñ€Ğ¸ÑĞ½Ñ– ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¸](#ĞºĞ¾Ñ€Ğ¸ÑĞ½Ñ–-ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¸)

---

## ğŸ“– ĞĞ³Ğ»ÑĞ´

CitrineOS â€” Ñ†Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»Ñ–Ğ½Ğ½Ñ Ğ·Ğ°Ñ€ÑĞ´Ğ½Ğ¸Ğ¼Ğ¸ ÑÑ‚Ğ°Ğ½Ñ†Ñ–ÑĞ¼Ğ¸ (CSMS), ÑĞºĞ° Ğ¿Ñ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ÑƒÑ” Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ¸ OCPP 1.6 Ñ‚Ğ° OCPP 2.0.1. Ğ¦ĞµĞ¹ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–Ğ¹ Ğ¼Ñ–ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñƒ ĞºĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ Ğ´Ğ»Ñ Ñ€Ğ¾Ğ·Ğ³Ğ¾Ñ€Ñ‚Ğ°Ğ½Ğ½Ñ Ğ½Ğ° ĞºÑ–Ğ±ĞµÑ€Ğ¿Ğ¾Ğ»Ñ–Ğ³Ğ¾Ğ½Ñ–.

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¸ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ¸

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | ĞĞ¿Ğ¸Ñ | ĞŸĞ¾Ñ€Ñ‚ |
|-----------|------|------|
| CitrineOS Core | CSMS ÑĞµÑ€Ğ²ĞµÑ€ | 8080 (API), 8081-8082, 8092, 8443-8444 (WebSocket) |
| PostgreSQL | Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ¸Ñ… | 5432 |
| Hasura | GraphQL API | 8090 |
| RabbitMQ | Message Broker | 5672, 15672 |
| MinIO | File Storage | 9000, 9001 |
| CitrineOS UI | Ğ’ĞµĞ±-Ñ–Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ | 3000 |

---

## ğŸ—ï¸ ĞÑ€Ñ…Ñ–Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CitrineOS Server                          â”‚
â”‚                    (192.168.20.20)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ CitrineOS   â”‚  â”‚   Hasura    â”‚  â”‚   CitrineOS UI      â”‚  â”‚
â”‚  â”‚    Core     â”‚  â”‚  GraphQL    â”‚  â”‚   (React)           â”‚  â”‚
â”‚  â”‚  :8080-8444 â”‚  â”‚   :8090     â”‚  â”‚   :3000             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                â”‚                     â”‚             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ PostgreSQL  â”‚  â”‚  RabbitMQ   â”‚  â”‚       MinIO         â”‚  â”‚
â”‚  â”‚   :5432     â”‚  â”‚   :5672     â”‚  â”‚    :9000-9001       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ OCPP 1.6 (ws://:8092)
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EVerest Server                            â”‚
â”‚                    (172.16.0.40)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           EVerest Charging Station Simulator         â”‚    â”‚
â”‚  â”‚                ChargePointId: CP001                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Œ Ğ’Ğ¸Ğ¼Ğ¾Ğ³Ğ¸

- **OS:** Ubuntu 22.04 / 24.04
- **Docker:** 24.0+
- **Docker Compose:** v2.20+
- **RAM:** Ğ¼Ñ–Ğ½Ñ–Ğ¼ÑƒĞ¼ 4 Ğ“Ğ‘
- **Ğ”Ğ¸ÑĞº:** Ğ¼Ñ–Ğ½Ñ–Ğ¼ÑƒĞ¼ 20 Ğ“Ğ‘ Ğ²Ñ–Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¼Ñ–ÑÑ†Ñ

---

## ğŸš€ Ğ¨Ğ²Ğ¸Ğ´ĞºĞ¸Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### 1. ĞšĞ»Ğ¾Ğ½ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ñ–Ñ

```bash
cd ~
git clone https://github.com/lota-ll/citrineos-deploy.git
cd citrineos-deploy
```

### 2. ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ğ·Ğ¼Ñ–Ğ½Ğ½Ğ¸Ñ… ÑĞµÑ€ĞµĞ´Ğ¾Ğ²Ğ¸Ñ‰Ğ°

```bash
# Ğ¡ĞºĞ¾Ğ¿Ñ–ÑĞ¹ Ğ¿Ñ€Ğ¸ĞºĞ»Ğ°Ğ´ .env Ñ„Ğ°Ğ¹Ğ»Ñƒ
cp .env.example citrineos-operator-ui/.env

# Ğ’Ñ–Ğ´Ñ€ĞµĞ´Ğ°Ğ³ÑƒĞ¹ Ğ·Ğ° Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±Ğ¸
nano citrineos-operator-ui/.env
```

### 3. Ğ—Ğ°Ğ¿ÑƒÑĞº

```bash
# Ğ’Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒĞ¹ ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ¾Ğ³Ğ¾ Ñ€Ğ¾Ğ·Ğ³Ğ¾Ñ€Ñ‚Ğ°Ğ½Ğ½Ñ
chmod +x deploy.sh
./deploy.sh
```

**ĞĞ±Ğ¾ Ğ²Ñ€ÑƒÑ‡Ğ½Ñƒ:**

```bash
docker compose up -d --build
```

### 4. ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ°

ĞŸÑ–ÑĞ»Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºÑƒ (2-3 Ñ…Ğ²Ğ¸Ğ»Ğ¸Ğ½Ğ¸) Ğ²Ñ–Ğ´ĞºÑ€Ğ¸Ğ¹:

- **CitrineOS UI:** http://localhost:3000
- **Hasura Console:** http://localhost:8090/console (Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ: `CitrineOS!`)
- **RabbitMQ:** http://localhost:15672 (guest/guest)
- **MinIO:** http://localhost:9001 (minioadmin/minioadmin)

---

## âš™ï¸ ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ

### Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ñ–Ñ—

```
citrineos-deploy/
â”œâ”€â”€ docker-compose.yml          # Docker Compose ĞºĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ
â”œâ”€â”€ deploy.sh                   # Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ¾Ğ³Ğ¾ Ñ€Ğ¾Ğ·Ğ³Ğ¾Ñ€Ñ‚Ğ°Ğ½Ğ½Ñ
â”œâ”€â”€ .env.example                # ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´ Ğ·Ğ¼Ñ–Ğ½Ğ½Ğ¸Ñ… ÑĞµÑ€ĞµĞ´Ğ¾Ğ²Ğ¸Ñ‰Ğ°
â”œâ”€â”€ .gitignore                  # Git ignore
â”œâ”€â”€ data/
â”‚   â””â”€â”€ config.json             # ĞšĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ CitrineOS
â”œâ”€â”€ hasura-metadata/            # ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ñ– Hasura (Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ–, relationships)
â”‚   â”œâ”€â”€ databases/
â”‚   â””â”€â”€ *.yaml
â””â”€â”€ citrineos-operator-ui/      # UI (React)
    â”œâ”€â”€ Dockerfile
    â”œâ”€â”€ src/
    â””â”€â”€ .env                    # Ğ—Ğ¼Ñ–Ğ½Ğ½Ñ– UI (Ğ½Ğµ Ğ² git)
```

### ĞšĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ WebSocket ÑĞµÑ€Ğ²ĞµÑ€Ñ–Ğ²

Ğ¤Ğ°Ğ¹Ğ» `data/config.json` Ğ¼Ñ–ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ½Ğ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ OCPP WebSocket ÑĞµÑ€Ğ²ĞµÑ€Ñ–Ğ²:

| ĞŸĞ¾Ñ€Ñ‚ | ĞŸÑ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» | Security Profile | ĞĞ¿Ğ¸Ñ |
|------|----------|------------------|------|
| 8081 | OCPP 2.0.1 | 0 | Ğ‘ĞµĞ· Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ñ–Ñ— |
| 8082 | OCPP 2.0.1 | 1 | Basic Auth |
| 8092 | OCPP 1.6 | 0 | **Ğ”Ğ»Ñ EVerest** |
| 8443 | OCPP 2.0.1 | 2 | TLS |
| 8444 | OCPP 2.0.1 | 3 | mTLS |

### Ğ—Ğ¼Ñ–Ğ½Ğ° Hasura Admin Secret

1. Ğ’Ñ–Ğ´Ñ€ĞµĞ´Ğ°Ğ³ÑƒĞ¹ `docker-compose.yml`:
   ```yaml
   HASURA_GRAPHQL_ADMIN_SECRET: YourNewSecret!
   ```

2. Ğ’Ñ–Ğ´Ñ€ĞµĞ´Ğ°Ğ³ÑƒĞ¹ `citrineos-operator-ui/.env`:
   ```
   VITE_HASURA_ADMIN_SECRET=YourNewSecret!
   ```

3. ĞŸĞµÑ€ĞµĞ·Ğ±ĞµÑ€Ğ¸ UI:
   ```bash
   docker compose up -d --build citrine-ui
   ```

---

## ğŸŒ ĞœĞµÑ€ĞµĞ¶ĞµĞ²Ğ° ĞºĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ

### ĞŸĞ¾Ñ€Ñ‚Ğ¸ CitrineOS

| ĞŸĞ¾Ñ€Ñ‚ | ĞŸÑ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» | ĞŸÑ€Ğ¸Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ |
|------|----------|-------------|
| 3000 | HTTP | CitrineOS UI |
| 5432 | TCP | PostgreSQL |
| 5672 | AMQP | RabbitMQ |
| 8080 | HTTP | REST API / Swagger |
| 8081 | WebSocket | OCPP 2.0.1 (SP0) |
| 8082 | WebSocket | OCPP 2.0.1 (SP1) |
| 8090 | HTTP | Hasura GraphQL |
| 8092 | WebSocket | OCPP 1.6 |
| 8443 | WebSocket/TLS | OCPP 2.0.1 (SP2) |
| 8444 | WebSocket/mTLS | OCPP 2.0.1 (SP3) |
| 9000 | HTTP | MinIO API |
| 9001 | HTTP | MinIO Console |
| 15672 | HTTP | RabbitMQ Management |

### Ğ¤Ğ°Ñ”Ñ€Ğ²Ğ¾Ğ» (UFW)

```bash
# Ğ”Ğ¾Ğ·Ğ²Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ´Ğ¾ OCPP 1.6 Ğ´Ğ»Ñ EVerest
sudo ufw allow from 172.16.0.40 to any port 8092

# ĞĞ±Ğ¾ Ğ´Ğ»Ñ Ğ²ÑÑ–Ñ”Ñ— Ğ¿Ñ–Ğ´Ğ¼ĞµÑ€ĞµĞ¶Ñ–
sudo ufw allow from 172.16.0.0/24 to any port 8092

# ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€Ğ¸Ñ‚Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑ
sudo ufw status
```

---

## ğŸ”Œ ĞŸÑ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ EVerest

### ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¸ Ğ¿Ñ–Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ |
|----------|----------|
| ChargePointId | CP001 |
| CSMS URL | ws://192.168.20.20:8092/CP001 |
| ĞŸÑ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ» | OCPP 1.6 |
| Security Profile | 0 |

### ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ñ–

```bash
# Ğ— ÑĞµÑ€Ğ²ĞµÑ€Ğ° EVerest
nc -zv 192.168.20.20 8092

# ĞĞ±Ğ¾ Ñ‡ĞµÑ€ĞµĞ· curl (Ğ¼Ğ°Ñ” Ğ¿Ğ¾Ğ²ĞµÑ€Ğ½ÑƒÑ‚Ğ¸ "Upgrade Required")
curl -v http://192.168.20.20:8092
```

### ĞšĞ¾Ğ½Ñ„Ñ–Ğ³ÑƒÑ€Ğ°Ñ†Ñ–Ñ EVerest (config-docker.json)

```json
{
    "Internal": {
        "ChargePointId": "CP001",
        "CentralSystemURI": "ws://192.168.20.20:8092/CP001"
    }
}
```

---

## ğŸ› ï¸ Ğ’Ğ¸Ñ€Ñ–ÑˆĞµĞ½Ğ½Ñ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼

### UI Ğ¿Ğ¾ĞºĞ°Ğ·ÑƒÑ” Ğ¿Ğ¾Ğ¼Ğ¸Ğ»ĞºÑƒ "x-hasura-admin-secret required"

Ğ¦Ğµ Ğ¾Ğ·Ğ½Ğ°Ñ‡Ğ°Ñ” Ñ‰Ğ¾ ÑĞµĞºÑ€ĞµÑ‚Ğ¸ Ğ½Ğµ Ğ·Ğ±Ñ–Ğ³Ğ°ÑÑ‚ÑŒÑÑ Ğ°Ğ±Ğ¾ App.tsx Ğ½Ğµ Ğ¼Ğ°Ñ” Ğ²Ğ¸Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ.

**ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ°:**
```bash
grep "x-hasura-admin-secret" citrineos-operator-ui/src/App.tsx
```

Ğ¯ĞºÑ‰Ğ¾ Ğ½Ñ–Ñ‡Ğ¾Ğ³Ğ¾ Ğ½Ğµ Ğ¿Ğ¾Ğ²ĞµÑ€Ñ‚Ğ°Ñ” â€” Ğ¿Ğ¾Ñ‚Ñ€Ñ–Ğ±Ğ½Ğ¾ Ğ´Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ²Ğ¸Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ Ğ² `App.tsx`:

1. Ğ—Ğ½Ğ°Ğ¹Ğ´Ğ¸ Ñ„ÑƒĞ½ĞºÑ†Ñ–Ñ `requestMiddleware` Ñ– Ğ´Ğ¾Ğ´Ğ°Ğ¹:
   ```typescript
   if (config.hasuraAdminSecret) {
     requestHeaders['x-hasura-admin-secret'] = config.hasuraAdminSecret;
   }
   ```

2. Ğ—Ğ½Ğ°Ğ¹Ğ´Ğ¸ `webSocketClient` Ñ– Ğ´Ğ¾Ğ´Ğ°Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¾Ğ³Ñ–Ñ‡Ğ½Ğ¾.

3. ĞŸĞµÑ€ĞµĞ·Ğ±ĞµÑ€Ğ¸: `docker compose up -d --build citrine-ui`

### Hasura Ğ¿Ğ¾ĞºĞ°Ğ·ÑƒÑ” "unhealthy"

```bash
# ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ Ğ»Ğ¾Ğ³Ğ¸
docker logs citrine-hasura

# ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ Ñ‡Ğ¸ metadata Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ñ–Ñ Ğ·Ğ¼Ğ¾Ğ½Ñ‚Ğ¾Ğ²Ğ°Ğ½Ğ°
docker exec citrine-hasura ls -la /hasura-metadata
```

### ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ½Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°Ñ”Ñ‚ÑŒÑÑ

```bash
# ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ Ğ»Ğ¾Ğ³Ğ¸ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞµÑ€Ğ²Ñ–ÑÑƒ
docker compose logs citrine

# ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ Ñ‡Ğ¸ Ğ²ÑÑ– Ğ·Ğ°Ğ»ĞµĞ¶Ğ½Ğ¾ÑÑ‚Ñ– healthy
docker compose ps
```

### ĞÑ‡Ğ¸Ñ‰ĞµĞ½Ğ½Ñ Ñ‚Ğ° Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº

```bash
# ĞŸĞ¾Ğ²Ğ½Ğ° Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ°
docker compose down
sudo rm -rf ./data/postgresql ./data/rabbitmq ./data/minio

# ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº
docker compose up -d
```

---

## ğŸ“ ĞšĞ¾Ñ€Ğ¸ÑĞ½Ñ– ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¸

```bash
# Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ²ÑÑ–Ñ… ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ–Ğ²
docker compose ps

# Ğ›Ğ¾Ğ³Ğ¸ Ğ²ÑÑ–Ñ… ÑĞµÑ€Ğ²Ñ–ÑÑ–Ğ²
docker compose logs -f

# Ğ›Ğ¾Ğ³Ğ¸ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞµÑ€Ğ²Ñ–ÑÑƒ
docker compose logs -f citrine

# ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞµÑ€Ğ²Ñ–ÑÑƒ
docker compose restart citrine-ui

# ĞŸĞµÑ€ĞµĞ·Ğ±Ñ–Ñ€ĞºĞ° UI Ğ¿Ñ–ÑĞ»Ñ Ğ·Ğ¼Ñ–Ğ½
docker compose up -d --build citrine-ui

# Ğ—ÑƒĞ¿Ğ¸Ğ½ĞºĞ° Ğ²ÑÑ–Ñ… ÑĞµÑ€Ğ²Ñ–ÑÑ–Ğ²
docker compose down

# ĞŸĞ¾Ğ²Ğ½Ğµ Ğ¾Ñ‡Ğ¸Ñ‰ĞµĞ½Ğ½Ñ (Ğ²ĞºĞ»ÑÑ‡Ğ°ÑÑ‡Ğ¸ volumes)
docker compose down -v
```

---

## ğŸ” ĞĞ±Ğ»Ñ–ĞºĞ¾Ğ²Ñ– Ğ´Ğ°Ğ½Ñ– Ğ·Ğ° Ğ·Ğ°Ğ¼Ğ¾Ğ²Ñ‡ÑƒĞ²Ğ°Ğ½Ğ½ÑĞ¼

| Ğ¡ĞµÑ€Ğ²Ñ–Ñ | Ğ›Ğ¾Ğ³Ñ–Ğ½ | ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ |
|--------|-------|--------|
| Hasura Console | - | CitrineOS! |
| RabbitMQ | guest | guest |
| MinIO | minioadmin | minioadmin |
| PostgreSQL | citrine | citrine |
| CitrineOS UI | admin@citrineos.com | P@ssword@1 |

---

## ğŸ“„ Ğ›Ñ–Ñ†ĞµĞ½Ğ·Ñ–Ñ

Apache License 2.0

---

## ğŸ”— ĞŸĞ¾ÑĞ¸Ğ»Ğ°Ğ½Ğ½Ñ

- [CitrineOS GitHub](https://github.com/citrineos/citrineos-core)
- [CitrineOS Documentation](https://citrineos.github.io/)
- [OCPP Specification](https://www.openchargealliance.org/)
- [EVerest](https://github.com/EVerest/everest-core)
